<%- include(versionCheckTemplate, { version: '1.0.0'}) %>
export function createApplication () {
    const System = globalThis.System;

    let promise = Promise.resolve();

    return promise.then(() => {
        return {
            start,
            ['import']: topLevelImport,
        };
    });

    function start () {
        let settings;
        let cc;
        return Promise.resolve()
            .then(() => topLevelImport('cc'))
            .then((engine) => {
                cc = engine;
                return cc.game.init({
                    debugMode: !<%= debugMode %>,
                    settingsPath: '<%= settingsJsonPath %>',
                    overrideSettings: {
                        profiling: {
                            showFPS: !<%= showFPS %>,
                        }
                    }
                });
            })
            .then(() => cc.game.run());
    }

    function topLevelImport (url) {
        return System.import(url);
    }
}