<% if(polyfillsBundleFile) { %>
// Polyfills bundle.
require("<%= polyfillsBundleFile %>");
<% } %>

// SystemJS support.
window.self = window;
require("<%= systemJsBundleFile %>");

const importMapJson = jsb.fileUtils.getStringFromFile("<%= importMapFile%>");
const importMap = JSON.parse(importMapJson);
System.warmup({
    importMap,
    importMapUrl: '<%= importMapFile%>',
    defaultHandler: (urlNoSchema) => {
        require(urlNoSchema.startsWith('/') ? urlNoSchema.substr(1) : urlNoSchema);
    },
});

System.import('<%= applicationJs %>').then(({ createApplication }) => {
    return createApplication();
}).then((application) => {
    return application.import('cc').then((cc) => {
        require('jsb-adapter/jsb-engine.js');
    }).then(() => {
        return application.start();
    });
}).catch((err) => {
    console.error(err.toString());
});
